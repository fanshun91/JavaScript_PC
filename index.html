<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>scroll防抖动</title>
    <style media="screen">
      .s-bar {
        width: 70%;
        height: 1600px;
        border: 1px solid #872;
      }
    </style>
  </head>
  <body>
    <div class="s-bar">

    </div>
    <script>
    /*
        //简单的防抖动函数
        function debounce(func, wait, immediate) {
          //定时器变量
          var timeout;
          return function() {
            //每次触发 scroll handler 时先清除定时器
            clearTimeout(timeout);
            //指定 xx ms 后触发真正想进行的操作 handler
            timeout = setTimeout(func, wait);
          };
        }

        function realFunc() {
          console.log("Success");
        }
    */

        //window.addEventListener("scroll", debounce(realFunc, 500));
        //window.addEventListener("scroll", realFunc);

        /**
         * 防抖动函数
         */
        function debounce(func, wait, immediate) {
          var timeout;
          return function() {
            var context = this,
                args = arguments;
                var later = function() {
                  timeout = null;
                  if(!immediate) {
                    func.apply(context, args);
                  }
                  var callNow = immediate & !timeout;
                  clearTimeout(timeout);
                  timeout = setTimeout(later, wait);
                  if(callNow) {
                    func.apply(context, args);
                  }
                };
          };
        }

        var myEfficientFn = debounce(function() {}, 300);

        // 节流函数
        function throttle(func, wait, mustRun) {
          var timeout,
              startTime = new Date();
          return function() {
            var context = this,
                args = arguments,
                curTime = new Date();
            clearTimeout(timeout);
            if(curTime - startTime >= mustRun) {
              func.apply(context, args);
              startTime = curTime;
            } else {
              timeout = setTimeout(func, wait);
            }
          };
        }

        function realFunc() {
          console.log("Success");
        }

        window.addEventListener('scroll', throttle(realFunc, 500, 1000));


        //rAF触发滚动事件
        var ticking = false;
        function onScroll() {
          if(!ticking) {
            requestAnimationFrame(realFunc);
            ticking = true;
          }
        }

        function realFunc() {
          console.log("Success");
          ticking = false;
        }

        window.addEventListener('scroll', onScroll, false);
    </script>
  </body>
</html>
